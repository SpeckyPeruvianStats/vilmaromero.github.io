<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.23" />
  <meta name="author" content="Vilma Romero">
  <meta name="description" content="Lecturer in Statistics">

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="/css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.0/css/academicons.min.css" integrity="sha512-GGGNUPDhnG8LEAEDsjqYIQns+Gu8RBs4j5XGlxl7UfRaZBhCCm5jenJkeJL8uPuOXGqgl8/H1gjlWQDRjd3cUQ==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather%7CRoboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  

  

  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Vilma Romero">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="Vilma Romero">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="/post/2017-02-14-causal-diagram/">

  

  <title>Causal Diagram | Vilma Romero</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Vilma Romero</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#talks">
            
            <span>Talks</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#cv">
            
            <span>CV</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
          </a>
        </li>

        
        

        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">Causal Diagram</h1>
    

<div class="article-metadata">

  <span class="article-date">
    <time datetime="2017-02-14 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Tue, Feb 14, 2017
    </time>
  </span>

  
  
  
  

  
  
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2f2017-02-14-causal-diagram%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Causal%20Diagram&amp;url=%2fpost%2f2017-02-14-causal-diagram%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2f2017-02-14-causal-diagram%2f&amp;title=Causal%20Diagram"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2f2017-02-14-causal-diagram%2f&amp;title=Causal%20Diagram"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Causal%20Diagram&amp;body=%2fpost%2f2017-02-14-causal-diagram%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    <div class="article-style" itemprop="articleBody">
      <p>In this post, I would like to introduce a customized <strong><code>ggplot2</code></strong> graphic that I did for my master dissertation. Basically, the plot will display how each latent ability found for Theory of Mind is affected by all the other abilities at previous times (we have information for three times). The process to find the latent abilities is not the main interest of the post, but it could be the topic for the next post. So let’s get back to the point.</p>
<div id="data" class="section level3">
<h3>Data</h3>
<p>To obtain the data used for the path diagram, I employed a classical linear approach. Each latent ability at time 2 was regressed with all the abilities at time 1 including itself. Similarly, it was done for time 3 against time 2. Only the significant relations of each regression (p-value&lt;0.05) were stored.</p>
<pre class="r"><code>mydata &lt;- read.table(&quot;data_causal.txt&quot;, header = TRUE, sep = &quot;\t&quot;)</code></pre>
<p>A small sample of the data is shown in the following table:</p>
<pre><code>## Warning: package &#39;knitr&#39; was built under R version 3.4.1</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">x</th>
<th align="center">xend</th>
<th align="center">y</th>
<th align="center">yend</th>
<th align="center">pval</th>
<th align="center">rsq</th>
<th align="center">x2</th>
<th align="center">xend2</th>
<th align="center">y2</th>
<th align="center">yend2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">2</td>
<td align="center">6</td>
<td align="center">6</td>
<td align="center">0.000017</td>
<td align="center">0.403304</td>
<td align="center">1.05</td>
<td align="center">1.95</td>
<td align="center">6.00</td>
<td align="center">6.00</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2</td>
<td align="center">5</td>
<td align="center">6</td>
<td align="center">0.004950</td>
<td align="center">0.403304</td>
<td align="center">1.05</td>
<td align="center">1.95</td>
<td align="center">5.05</td>
<td align="center">5.95</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">3</td>
<td align="center">5</td>
<td align="center">1</td>
<td align="center">0.041056</td>
<td align="center">0.834008</td>
<td align="center">2.05</td>
<td align="center">2.95</td>
<td align="center">4.80</td>
<td align="center">1.20</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">3</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0.000000</td>
<td align="center">0.834008</td>
<td align="center">2.05</td>
<td align="center">2.95</td>
<td align="center">1.00</td>
<td align="center">1.00</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>x</strong> is the departure time.</li>
<li><strong>xend</strong> is the arrival time.</li>
<li><strong>y</strong> is the ability (eg. 6 = Non Verbal False Belief, 1 = Location Change) considered as dependent variable in the regression at time <strong>x</strong>.</li>
<li><strong>yend</strong> is the ability considered as independent variable in the regression at time <strong>xend</strong>.</li>
<li><strong>pval</strong> is the p-value of the relation between <strong>y</strong> and <strong>yend</strong>.</li>
<li><strong>rsq</strong> is the coefficient of determination (<span class="math inline">\(R^2\)</span>) of the regression.</li>
</ul>
<p>The last four variables (<strong>x2</strong>, <strong>xend2</strong>, <strong>y2</strong>, <strong>yend2</strong>) were created based on the first ones to have a better location to be considered in the plot.</p>
</div>
<div id="plot" class="section level3">
<h3>Plot</h3>
<p>First, let’s define a function that will help us to choose a pretty color.</p>
<pre class="r"><code>gg_color_hue &lt;- function(n) {
  hues = seq(15, 375, length = n+1)
  hcl(h = hues, l = 65, c = 100)[1:n]
}</code></pre>
<p>Finally, the code for the causal diagram is as follows:</p>
<pre class="r"><code>library(ggplot2)

ggplot(mydata) + 
  geom_segment(aes(x = x2, y = y2, xend = xend2, yend = yend2, col = pval), alpha = 0.3, 
               arrow = arrow(length = unit(0.15,&quot;inches&quot;)), size = 0.8) +
  scale_color_gradient(high = &quot;gray&quot;, low = &quot;black&quot;, name = &quot;p-value&quot;) +
  geom_point(aes(x = xend, y = yend, size = rsq), col = gg_color_hue(4)[1]) +
  scale_x_continuous(breaks = 1:3) + 
  scale_y_continuous(breaks = 1:6, labels = c(&quot;Location Change&quot;,&quot;Narrative&quot;,&quot;Deceptive Box&quot;,
                                              &quot;Verbal FB&quot;,&quot;Pretense, Desire, Think&quot;,
                                              &quot;Non Verbal FB&quot;)) + 
  labs(x = &quot;Time&quot;, y = NULL)  +
  guides(size = guide_legend(title = expression(R^2)))</code></pre>
<p><img src="/post/2017-02-14-causal-diagram_files/figure-html/causal-diagram-1.png" width="672" /></p>
</div>
<div id="interpretation" class="section level3">
<h3>Interpretation</h3>
<p>The red shaded circles stands for the goodness of fit, which in linear models is the <span class="math inline">\(R^2\)</span>, and it varies according to its value. Additionally, the darker the arrow is, the more significant becomes the precedent ability in explaining the respective latent ability at this time point.</p>
<p>It can be clearly seen that Pretense, Desire and Think can be explained at Time 2 by the same abilities and Non Verbal False Believe abilities had at Time 1. The same pattern is looked for Non Verbal False Belief at Time 2 which is summarised by its previous ability and the Pretense, Desire and Think ability at Time 1. However, these last causality is less accurate since its <span class="math inline">\(R^2\)</span> value is smaller. Even though there is an arrow from Location Change ability at Time 1 to Verbal False Belief ability at Time 2 indicating causality, it is not that much significant (<span class="math inline">\(p-value \approx 0.05\)</span>) and also the <span class="math inline">\(R^2\)</span> is around 50 %. The remaining abilities at Time 2 are as well explained by themselves at Time 1.</p>
<p>At Time 3, all the abilities are caused by their previous time point value. The remarkable pattern is shown by Pretense, Desire and Think at Time 2 explaining three dimensions at Time 3 apart form itself: Non Verbal False Belief, Dceptive Box and Location Change. These last with not a strong p-value but it still having a good precision (<span class="math inline">\(R^2\)</span> around 0.8). Moreover, Non Verbal False Belief ability seem to be explained also by the Narrative factor, but the significance is almost at the boundary and can be because the p-values, in general, have not been adjusted for multiple comparison.</p>
</div>

    </div>
  </div>

</article>

<div class="container">
  <nav>
  <ul class="pager">
    

    
  </ul>
</nav>

</div>

<div class="article-container">
  
<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'vilsurr';
    var disqus_identifier = '\/post\/2017-02-14-causal-diagram\/';
    var disqus_title = 'Causal Diagram';
    var disqus_url = '\/post\/2017-02-14-causal-diagram\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>


</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 Vilma Romero &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha512-jGsMH83oKe9asCpkOVkBnUrDDTp8wl+adkB2D+//JtlxO4SrLoJdhbOysIFQJloQFD+C4Fl1rMsQZF76JjV0eQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js" integrity="sha512-iHzEu7GbSc705hE2skyH6/AlTpOfBmkx7nUqTLGzPYR+C1tRaItbRlJ7hT/D3YQ9SV0fqLKzp4XY9wKulTBGTw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/TweenMax.min.js" integrity="sha512-Z5heTz36xTemt1TbtbfXtTq5lMfYnOkXM2/eWcTTiLU01+Sw4ku1i7vScDc8fWhrP2abz9GQzgKH5NGBLoYlAw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/plugins/ScrollToPlugin.min.js" integrity="sha512-CDeU7pRtkPX6XJtF/gcFWlEwyaX7mcAp5sO3VIu/ylsdR74wEw4wmBpD5yYTrmMAiAboi9thyBUr1vXRPA7t0Q==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

